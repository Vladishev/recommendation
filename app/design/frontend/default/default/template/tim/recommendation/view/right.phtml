<?php
$productId = Mage::registry('current_product')->getId();
$opinionData = $this->getOpinionData($productId);
$averageRating = $this->getProductEvaluation($productId);
$byIt = $opinionData['by_it'] ? 1 : 0;
$recommend = $opinionData['recommend'] ? 1 : 0;
?>
<div class="tim-rating"> <!-- main container for rating part of opinion -->
    <div class="tim-rating-title"><?php echo $this->__('EVALUATION OF PRODUCT'); ?>:</div>
    <div class="tim-rating-score-main">
        <?php echo $averageRating ?><span>/5<span>
    </div>
    <div class="tim-rating-score-part">
        <?php echo $this->__('Value for money'); ?>:
        <div class="tim-chart tim-pricequality">
            <div class="tim-chart-stars tim-stars-<?php echo $opinionData['rating_price'] ?>">
                <?php echo $opinionData['rating_price'] ?>/5
            </div>
        </div>
    </div>
    <div class="tim-rating-score-part">
        <?php echo $this->__('Product durability'); ?>:
        <div class="tim-chart tim-durability">
            <div class="tim-chart-stars tim-stars-<?php echo $opinionData['rating_durability'] ?>">
                <?php echo $opinionData['rating_durability'] ?>/5
            </div>
        </div>
    </div>
    <div class="tim-rating-score-part">
        <?php echo $this->__('Product failure'); ?>:
        <div class="tim-chart tim-failure">
            <div class="tim-chart-stars tim-stars-<?php echo $opinionData['rating_failure'] ?>">
                <?php echo $opinionData['rating_failure'] ?>/5
            </div>
        </div>
    </div>
    <div class="tim-rating-score-part">
        <?php echo $this->__('Easy to install'); ?>:
        <div class="tim-chart tim-assembly">
            <div class="tim-chart-stars tim-stars-<?php echo $opinionData['rating_service'] ?>">
                <?php echo $opinionData['rating_service'] ?>/5
            </div>
        </div>
    </div>
    <div class="tim-rating-score-part">
        <?php echo $this->__("Do you purchased this product"); ?>:
        <div class="tim-chart-boolean">
            <span id="byIt-yes"><?php echo $this->__('Yes'); ?></span><span id="byIt-no"><?php echo $this->__('No'); ?></span>
        </div>
    </div>
    <div class="tim-rating-score-part">
        <?php echo $this->__('Do you recommend this product'); ?>:
        <div class="tim-chart-boolean">
            <span id="recommend-yes"><?php echo $this->__('Yes'); ?></span><span id="recommend-no"><?php echo $this->__('No'); ?></span>
        </div>
    </div>
</div>
<script type="text/javascript">
    var byIt = <?php echo $byIt; ?>;
    var recommend = <?php echo $recommend; ?>;
    if (byIt) {
        jQuery('#byIt-yes').addClass('tim-chart-boolean-active');
    } else {
        jQuery('#byIt-no').addClass('tim-chart-boolean-active');
    }
    if (recommend) {
        jQuery('#recommend-yes').addClass('tim-chart-boolean-active');
    } else {
        jQuery('#recommend-no').addClass('tim-chart-boolean-active');
    }
</script>